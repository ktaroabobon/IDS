# 仕様の仕組み

**仕様(Specifications)** は、人間が理解しやすいように設計されています。
しかし、**仕様**はコンピュータソフトウェアがあいまいさなく情報要件を自動的かつ正確にチェックできるように、高度に構造化されています。
すべての**仕様**には3つの主要な部分があります：

1. **説明(Description)**：**仕様**の理由とそれを達成する方法の説明。
   この部分は、情報が要求されている理由を人間が読んで理解するために設計されています。

このフィールドはまた、さまざまな適用範囲のファセットを理由付けし、それらが個々にではなく、資産全体として関連するデータ契約を識別するためにどのように役立つかを記述するために使用されます。逆に、各要件のファセットにおける`description`
データは、ユーザーが必要な個々の情報の目的を理解するのに役立ちます。

2. **適用範囲(Applicability)**：私たちが指定しようとしているモデルのサブセットを識別します。
   IFCモデルには多種多様なオブジェクトがありますが、各**仕様**はサブセットにのみ適用されます。
   サブセットは、エンティティ（例：壁、窓）、分類（例：Uniclass EF_25_10_25 外壁）などの利用可能なファセットを介して識別できます。
3. **要件(Requirements)**：適用範囲で識別されたサブセットに必要な情報、例えば必要なプロパティや材料です。

例えば、"_すべての壁には耐火性のプロパティが必要です_"という**仕様**は以下のように構成されます：

1. **説明**：壁の耐火性は建築基準の遵守に不可欠です
2. **適用範囲**：この仕様はすべての壁オブジェクトに適用されます
3. **要件**：前述の壁オブジェクトは耐火性のプロパティを持たなければなりません

## 仕様(Specifications)の記述方法

**適用範囲**と**要件**は一連の**ファセット**を使用して記述されます。**ファセット**は、モデル内の単一のエンティティ（例：壁、ドアなど）が持つ可能性のある情報を記述します。
**ファセット**は固定された**ファセットパラメータ**を使用して情報を正確に記述し、コンピュータがあなたが求める情報を正確に理解できるようにします。

**適用範囲**セクションで**ファセット**が使用される場合、モデルの関連部分を識別するために使用する情報を記述します。

**要件**セクションで**ファセット**が使用される場合、モデルの部分が**仕様**に準拠するために満たさなければならない情報の制約を記述します。

![IDS構造](../Documentation/ids-structure.png)

情報の6つの異なる**ファセット**があります：

| ファセットタイプ               | ファセットパラメータ                    | 適用範囲の例                                                             | 要件の例                                                              |
|------------------------|---------------------------|--------------------------------------------------------------------|-------------------------------------------------------------------|
| **Entity(エンティティ)**     | **IFCクラス**と**事前定義されたタイプ** | "IfcWall"で事前定義されたタイプが"SHEAR"のものに適用                                 | "IfcWall"で事前定義されたタイプが"SHEAR"のものである必要があります                         |
| **Attribute(属性)**      | **名前**と**値**              | 属性"Name"が値"W01"を持つ要素に適用                                            | 属性"Name"が値"W01"を持つ必要があります                                         |
| **Classification(分類)** | **システム**と**値**            | "Uniclass 2015"で"EF_25_10_25"として分類された要素に適用                         | "Uniclass 2015"の分類参照で"EF_25_10_25"を持つ必要があります                      |
| **Property(プロパティ)**    | **プロパティセット**、**名前**、**値** | "Pset_WallCommon"のプロパティセットを持ち、"LoadBearing"プロパティが"TRUE"に設定された要素に適用 | "Pset_WallCommon"のプロパティセットを持ち、"LoadBearing"プロパティが"TRUE"である必要があります |
| **Material(材料)**       | **値**                     | "コンクリート"要素に適用                                                      | "コンクリート"材料を持つ必要があります                                              |
| **Parts(部品)**          | **エンティティ**と**関係**         | "IfcSpace"に"含まれる"要素に適用                                             | "IfcSpace"に"含まれる"必要があります                                          |

**適用範囲**または**要件**セクションのどちらかで複数の**ファセット**を組み合わせて、さまざまな**仕様**を記述できます。
一部の**ファセット**にはオプショナルな**ファセットパラメータ**があります。
たとえば、プロパティが存在することを指定したいが、その正確な値までは指定しない場合、**プロパティファセット**の値パラメータを省略できます。

また、一部の**ファセットパラメータ**に対して有効な値のリスト、数値の範囲、またはテキストパターンを指定することもできます。これらは*
*複雑な制約**として知られています。
たとえば、耐火性のプロパティが"0HR"、"1HR"、"2HR"のいずれかの値からのみ選択するように指定する場合、**複雑な制約**を使用します。

いくつかの例を挙げてみましょう：

| 意図                                      | 適用範囲                                                                                                                                                       | 要件                                                                                                                                                                             |
|-----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 外部の荷重を支える壁はコード遵守のために耐火性のプロパティを持つ必要があります | <ul><li>**エンティティファセット(Entity)**（**IFCクラス**がIfcWall）</li><li>**プロパティファセット(Property)**（**プロパティセット**がPset_WallCommon、**名前**がLoadBearing、**値**がTRUE）</li></ul> | <ul><li>**プロパティファセット(Property)**（**プロパティセット**がPset_WallCommon、**名前**がFireRating）</li></ul>                                                                                     |
| ベッドルームは最小10平米のファセット積を持つべきです             | <ul><li>**エンティティファセット(Entity)**（**IFCクラス**がIfcSpace）</li><li>**属性ファセット(Attribute)**（**説明**にテキスト"BEDROOM"を含む必要がある）</li></ul>                                | <ul><li>**プロパティファセット(Property)**（**プロパティセット**がQto_SpaceBaseQuantities、**名前**がNetFloorArea、**値**が>= 10）</li></ul>                                                               |
| すべてのレンガ壁タイプは分類され、承認された命名規則に従う必要があります    | <ul><li>**エンティティファセット(Entity)**（**IFCクラス**がIfcWallType）</li><li>**材料ファセット(Material)**（**値**がbrick）</li></ul>                                               | <ul><li>**分類ファセット(Classification)**（**システム**がUniclass 2015、**値**はEF_25_10で始まる必要がある）</li><li>**属性ファセット(Attribute)**（**名前**がName、**値**は2つの数字を続けた文字"WT"、例えばWT01、WT02など）</li></ul> |

各**ファセット**が指定できる全能力を見るために、詳細なセクションを以下で確認してください。

## 基数(Cardinality)

### 適用範囲エンティティの基数

各**仕様**は、適用範囲基準に一致するモデルのサブセットが**必須**、**オプショナル**、または**禁止**であることを定義します。
以下のような例が与えられた場合：

```txt
適用範囲 =  タイプ = 壁
         プロパティ = IsExternal
要件   =  プロパティ = FireRating
```

以下の解釈が適用されます：

| minOccurs | maxOccurs | 解釈                  | 意味                                                                 |
|-----------|-----------|---------------------|--------------------------------------------------------------------|
| 1         | 無制限       | **必須(required)**    | IFCモデル内には、少なくとも1つのIsExternal特性を持つ壁が見つかる必要があり、各壁は火災評価特性を持たなければなりません |
| 0         | 無制限       | **オプション(optional)** | IsExternal特性を持つ壁はモデル内でオプションです、そのような壁が存在する場合、すべて火災評価特性を持たなければなりません  |
| 0         | 0         | **禁止(prohibited)**  | モデル内にIsExternal特性を持つ壁が見つからないようにするべきです、要件はモデルの検証で無視されます             |

### 要件基数

個々の要件側ファセットも、それらが**必須**、**オプション**、または**禁止**であるかどうかを指定できます。

次のような属性の例が与えられた場合：

```txt
要件1: 特性
    特性セット: ePset_SpaceOMA 
    特性: TravelDirection
    データタイプ: IFCLABEL
```

次の解釈が適用されます：

| タイプ        | 意味                                          | 成功基準                                                                            |
|------------|---------------------------------------------|---------------------------------------------------------------------------------|
| **必須**     | モデル内に一致するプロパティが必要です                         | 一致するエンティティはePset_SpaceOMA/TravelDirectionプロパティをIFCLABELタイプで非null値を持っていなければなりません |
| **禁止**     | 一致するプロパティがモデル内に存在してはいけません                   | 一致するエンティティはePset_SpaceOMAプロパティセット内にTravelDirectionプロパティを持っていません                 |
| **オプショナル** | プロパティセット/プロパティおよび値の制約の期待は定義されていますが、オプショナルです | 一致するエンティティはプロパティを持たないか、または持っている場合、期待されるデータタイプおよび値です                             |

完全な例として、モデルが耐荷重壁を含まないようにしたい場合、壁エンティティに適用される**必須**の仕様があり、それが**禁止**
されている場合があります。

## IFCスキーマのサポート

各**仕様**は、それが適用されるIFCスキーマを定義します。サポートされているIFCスキーマは以下の通りです：

- IFC4X3
- IFC4
- IFC2X3

IDSは提供されたIFCモデルが有効なデータのみを含むと仮定します。もしモデルに構文エラーやIFCスキーマの検証エラーがある場合、そのモデルは検証可能ではないかもしれません。
生成されたIFCが有効であることを保証するのは、そのIFCを作成したソフトウェアの責任です。

## 制限事項

IDSの最初のバージョンは、すべての分野に共通のIFCの基本情報と関係性を対象としています。
より高度な情報要件は現在、IDSの範囲外です。
例えば、ジオメトリチェック、計算されたまたは動的な値に依存するチェック、IFCモデルの外部のデータを参照するチェック、またはドメイン固有のIFC関係を使用することはできません。

以下は、他のツールを使用して監査する必要がある高度な要件のタイプです：

- 構造用ビームと配管の間に衝突があってはならない
- すべての壁は敷地境界から3m離れていなければならない
- すべてのオフィススペースの総ファセット積は300m2を超えなければならない
- すべてのドアタイプの名前は一意でなければならない
- すべてのポンプには指名された供給者と製造者が必要である
- すべての空調ユニットにはトリガーイベントを持つセンサーが割り当てられていなければならない
- 土曜日と日曜日はすべての作業スケジュールで休日でなければならない
- すべてのモデルは主要なソフトウェアベンダーによって3分以内にロードされなければならない
- モデル内の関連図ファセットはCDEの最新の改訂と一致していなければならない
- すべての鉄筋はパラメトリックな掃引円盤としてモデル化されるべきである
- モデルは建設の実際の状態と一致していなければならない
