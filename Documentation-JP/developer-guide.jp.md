**警告: IDSはまだ正式にリリースされていません。**

IDSファイルは、単なるXMLファイルであり、そのスキーマはXSDで定義されています。既存のIDSファイルを開いて内容を調べることで、IDSがどのように構成されているかを感じ取ることができます。

IDSがXSDベースの検証チェックをパスした場合、有効と見なされます。buildingSMARTディレクトリの公開IDSテンプレートにあるすべてのサンプルIDSファイルは、有効であることが保証されています。

1. [最新のIDS XSDスキーマをダウンロード](https://github.com/buildingSMART/IDS/blob/master/Development/ids.xsd)
2. `Documentation/testcases`フォルダーからサンプルIDSファイルをダウンロード

多くの無料のオンラインツールやプログラミングライブラリがXSD検証を行うことができます。
ただし、有効なIDSファイルには単なるXMLスキーマの準拠以上が必要です。buildingSMARTは、生成または受信したIDSファイルが完全に有効であることを確認するための[IDS監査ツール](https://github.com/buildingSMART/IDS-Audit-tool/)を提供しています。同じツールは、[Xbim IDS監査サービス](https://www.xbim.it/ids)で利用可能であり、ローカルのWebブラウザで実行され、IDSファイルをサーバーにアップロードしません。

## IDSの作成

IDSファイルの読み取りと作成のみを行うソフトウェアを書いている場合、以下の基準を満たす必要があります：

- すべてのIDSソフトウェアは、有効なIDSファイルのみを読み書きする必要があります。
- 独自の拡張は許可されません。IDSまたは対応するIFCモデルを補完するために補助システム（例：追加のメタデータの読み込み）が使用される場合、それがIDS外部のものであることをユーザーに明確にする必要があります。
- データの損失が発生してはなりません。IDSの読み込みと保存は、その情報のすべてを保存する必要があります。データが変更されない限り、文法のフォーマット変更は許可されます。

さらに、ユーザーに以下の機能を提供することを強く推奨します：

- **エンティティファセット**でIFCクラスを書く際、インターフェイスは選択されたIFCスキーマの有効なIFCクラス名に許可される値を制限する必要があります。オートコンプリートが推奨されます。
- **エンティティファセット**で事前定義されたタイプを書く際、インターフェイスは指名されたIFCクラスに基づいて許可される値を推奨する必要がありますが、ユーザーがカスタム事前定義タイプを書くことも許可する必要があります。オートコンプリートが推奨されます。
- **エンティティファセット**をすでに指定しており、**属性ファセット**を作成している場合、インターフェイスは指名されたIFCクラスに基づいて許可される値を制限する必要があります。インターフェイスは、指名された属性名に基づいて正しいデータタイプを使用するようにユーザーを導くべきです。
- **エンティティファセット**をすでに指定しており、**プロパティファセット**を作成している場合、インターフェイスは指名されたIFCクラスおよび事前定義タイプに基づいて許可されるプロパティセットを推奨する必要があります。ただし、カスタムプロパティセット名の記述も許可する必要があります。標準化された（例：`Pset_` または `Qto_`）プロパティセットが指名された場合、インターフェイスは許可されるプロパティ名を制限し、使用される適切なデータタイプを推奨する必要があります。
- **プロパティファセット**でカスタムプロパティの文字列が指定された場合、IfcLabelをデフォルトのデータタイプとすることが望ましいです
- **プロパティファセット**でカスタムプロパティの整数が指定された場合、IfcIntegerをデフォルトのデータタイプとすることが望ましいです
- **プロパティファセット**でカスタムプロパティの浮動小数点が指定された場合、IfcRealをデフォルトのデータタイプとすることが望ましいです
- ユーザーが単位を指定して値を記述する場合、ユーザーが好みの単位でIDSを記述できるように変換ツールを提供する必要があります
- 一般的に知られているシステムのために標準化された分類名を事前に読み込むこともできます。また、綴りミスを防ぐために分類参照を事前に読み込むこともできます。このために、[IFC分類システムディレクトリ](https://github.com/Moult/ifcclassification)を使用することを選択できます。
- ユーザーが**材料ファセット**を指名する際、インターフェイスはIFC推奨の材料カテゴリー（'concrete', 'steel', 'aluminium', 'block', 'brick', 'stone', 'wood', 'glass', 'gypsum', 'plastic', 'earth'のいずれか）を推奨する必要があります

## IFCに対するIDSのチェック

IDSチェックを実装するソフトウェアは、`Documentation/testcases`フォルダーにあるIFC/IDSペアのテストスイートに準拠する必要があります（[テストケースのドキュメント](../Documentation/testscases/scripts.md)を参照）。

さらに、ユーザーに以下の機能を提供することも強く推奨されます：

- IDS監査結果はBCF-XML形式で保存されることが想定されていますが、またはBCF-APIを介してOpenCDEに接続されることもあります。ただし、これらの結果をBCFでどのようにフォーマットおよび構造化するかは、現時点では指定されていません。
- ソフトウェアがIDS仕様で指名されたIFCバージョンを解析することができない場合、ユーザーにその制限を知らせる必要があります。
- 要件がオプショナルであるが、要求された場合に失敗する場合、チェッカーツールはエラーをログに記録してはならず、補助的な警告や推奨事項を提供することができます

### 精度

浮動小数点数が数値`x`に等しいと見なされる場合、それは`(x * (1. - 1.e-6) - 1.e-6)`と`(x * (1. + 1.e-6) + 1.e-6)`の範囲（排他的）の間にある場合です。

これは、小さい単位から大きな単位までの精度をスケールすることを可能にする妥協と簡素化です。

### 制約

XSDには**Total Digits**と**Fraction Digits**の制約も含まれます。これらはIDSではサポートされず、限られた有用性を持つためです。

### オプショナリティ

仕様は、モデル上の`applicability`の必要なマッチに応じて、**Required**（必須）、**Optional**（オプショナル）、または**Prohibited**（禁止）に設定することができます。
これはXSDの`minOccurs`および`maxOccurs`機能を使用して表されます。以下の状態で表されます：

| オプショナリティ | minOccurs | maxOccurs |
| --------------- | --------- | --------- |
| Required        | 1         | unbounded |
| Optional        | 0         | unbounded |
| Prohibited      | 0         | 0         |

`minOccurs`と`maxOccurs`の他の構成は現在許可されていません。

## 利用可能な開発者ライブラリ

開発を始めるために、アプリケーションで使用できるIDSライブラリのディレクトリをここに示します。[あなたのライブラリを提出](https://github.com/buildingSMART/IDS/pulls)してください。

| 言語 | ライセンス           | ライブラリ                                      | メモ                                                               |
| ---- | ------------------- | --------------------------------------------- | ------------------------------------------------------------------ |
| C#   | CDDL                | [XBim](https://github.com/CBenghi/Xbim.Xids)  | 検証ライブラリも利用可能であり、商用ライセンスがあります |
| Python | LGPL-3.0-or-later | [IfcOpenShell](https://ifcopenshell.org/)     |                                                                    |
| ?    | ?                   | ODA?                                          |                                                                    |

ライブラリの貢献者を歓迎します。リストを更新したい場合は、プルリクエストを提案してください。

## より詳しいドキュメント

- [実装をソフトウェアベンダーディレクトリに追加する](https://technical.buildingsmart.org/resources/software-implementations/)
- [改善の提案をする](https://github.com/buildingSMART/IDS/issues)
